# 行为准则模块 (Behavior Guidelines Module)
#
# 功能：定义 Agent 应该遵循的行为规范和原则
# 适用场景：需要约束 Agent 行为边界的提示词
# 版本：1.0.0
# 创建日期：2025-12-07

name: behavior_guidelines
version: "1.0.0"
description: |
  行为准则模块用于声明 Agent 应该遵循的核心原则、约束条件和禁止行为。
  确保 Agent 在安全、可控的范围内运行。

# 变量定义
variables:
  - principles         # 核心原则
  - constraints        # 约束条件
  - forbidden_actions  # 禁止行为

# 适用的 Agent 类型
applicable_agents:
  - ConversationAgent
  - WorkflowAgent
  - CoordinatorAgent

# 模板内容
template: |
  ## 行为准则

  ### 核心原则
  {principles}

  ### 约束条件
  {constraints}

  ### 禁止行为
  {forbidden_actions}

# 元数据
metadata:
  category: behavior
  priority: 2
  author: system
  changelog:
    - version: "1.0.0"
      date: "2025-12-07"
      changes: "初始版本"

# 变量说明
variable_descriptions:
  principles:
    type: string
    required: true
    description: "Agent 应该遵循的核心原则"
    examples:
      - |
        1. **安全第一**：不执行任何可能造成系统损害的操作
        2. **用户优先**：始终以用户利益为中心
        3. **透明可解释**：决策过程应该可追溯和解释
      - "可靠性、一致性、可预测性"

  constraints:
    type: string
    required: true
    description: "Agent 运行时的约束条件"
    examples:
      - |
        - 时间约束：整个工作流最大执行时间 5 分钟
        - 并发限制：同时执行的任务数量不超过 3 个
        - API 限制：避免过度调用外部 API
      - "遵循 DAG 拓扑顺序、不跳过必要节点、保持状态一致性"

  forbidden_actions:
    type: string
    required: true
    description: "Agent 禁止执行的行为"
    examples:
      - |
        - 删除系统关键文件
        - 访问未授权的敏感数据
        - 执行未经验证的外部代码
        - 泄露用户隐私信息
      - "跳过验证步骤、无限重试、忽略错误、强制终止其他 Agent"

# 使用示例
usage_examples:
  - name: "ConversationAgent 行为准则"
    variables:
      principles: |
        1. **准确理解**：准确理解用户意图，不做过度假设
        2. **渐进式执行**：优先简单方案，逐步增加复杂度
        3. **及时反馈**：保持与用户的沟通，及时汇报进度
      constraints: |
        - ReAct 循环最多 10 次迭代
        - 复杂任务必须先分解再执行
        - 不确定时询问用户确认
      forbidden_actions: |
        - 在未分类意图前直接执行复杂操作
        - 忽略用户的明确拒绝
        - 自动执行高风险操作

  - name: "CoordinatorAgent 行为准则"
    variables:
      principles: |
        1. **公正裁决**：对所有 Agent 的请求一视同仁
        2. **及时响应**：快速处理验证请求，不阻塞主流程
        3. **完整记录**：记录所有决策和验证结果
      constraints: |
        - 验证必须在 100ms 内完成
        - 规则优先级严格按数字排序
        - 失败处理策略明确无歧义
      forbidden_actions: |
        - 绕过规则验证直接放行
        - 修改其他 Agent 的状态
        - 删除审计日志
