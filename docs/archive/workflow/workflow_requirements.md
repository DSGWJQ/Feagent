# å·¥ä½œæµéœ€æ±‚å˜æ›´è¯´æ˜

## ğŸ“‹ éœ€æ±‚å˜æ›´æ¦‚è¿°

**å˜æ›´æ—¥æœŸ**: 2025-01-15
**å˜æ›´ç±»å‹**: æ ¸å¿ƒåŠŸèƒ½é‡å¤§è°ƒæ•´

---

## ğŸ¯ æ–°éœ€æ±‚ï¼šè¡¨å•åˆ›å»º + å¯¹è¯/æ‹–æ‹½è°ƒæ•´å·¥ä½œæµ

### æ ¸å¿ƒç†å¿µ

**ç±»ä¼¼æ‰£å­ï¼ˆCozeï¼‰çš„ Agent åˆ›å»ºå¹³å°**ï¼š
- **ç¬¬ä¸€æ­¥**ï¼šç”¨æˆ·å¡«å†™è¡¨å•ï¼ˆèµ·ç‚¹ + ç»ˆç‚¹ + æè¿°ï¼‰
- **ç¬¬äºŒæ­¥**ï¼šAI è‡ªåŠ¨ç”Ÿæˆæœ€å°å¯è¡Œå·¥ä½œæµï¼ˆWorkflowï¼‰
- **ç¬¬ä¸‰æ­¥**ï¼šç”¨æˆ·é€šè¿‡å¯¹è¯æˆ–æ‹–æ‹½è°ƒæ•´å·¥ä½œæµ
- **ç¬¬å››æ­¥**ï¼šæ‰§è¡Œå·¥ä½œæµï¼Œå®æ—¶æ˜¾ç¤ºæ¯ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€

---

## ğŸ”„ éœ€æ±‚å¯¹æ¯”

### ä¹‹å‰çš„è®¾è®¡

```
ç”¨æˆ·å¡«å†™è¡¨å•ï¼ˆèµ·ç‚¹ + ç›®çš„ï¼‰
    â†“
ç³»ç»Ÿåˆ›å»º Agent
    â†“
æ‰§è¡Œ Agent
```

**é—®é¢˜**ï¼š
- âŒ æ— æ³•çœ‹åˆ°æ‰§è¡Œæµç¨‹
- âŒ æ— æ³•çµæ´»è°ƒæ•´æ‰§è¡Œæµç¨‹
- âŒ ç¼ºå°‘å¯è§†åŒ–åé¦ˆ

---

### ç°åœ¨çš„è®¾è®¡

```
ç”¨æˆ·å¡«å†™è¡¨å•ï¼ˆèµ·ç‚¹ + ç»ˆç‚¹ + æè¿°ï¼‰
    â†“
AI ç”Ÿæˆæœ€å°å¯è¡Œå·¥ä½œæµï¼ˆWorkflowï¼‰
    â†“
ç”¨æˆ·é€šè¿‡å¯¹è¯æˆ–æ‹–æ‹½è°ƒæ•´å·¥ä½œæµ
    â†“
æ‰§è¡Œå·¥ä½œæµ
    â†“
å®æ—¶æ˜¾ç¤ºæ¯ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€ï¼ˆæˆåŠŸ/å¤±è´¥/è¿è¡Œä¸­/æœªæ‰§è¡Œï¼‰
```

**ä¼˜åŠ¿**ï¼š
- âœ… è¡¨å•å¼•å¯¼ï¼Œé™ä½é¦–æ¬¡ä½¿ç”¨é—¨æ§›
- âœ… å¯è§†åŒ–å·¥ä½œæµï¼Œç”¨æˆ·èƒ½çœ‹åˆ°æ‰§è¡Œæµç¨‹
- âœ… çµæ´»è°ƒæ•´ï¼Œæ”¯æŒå¯¹è¯å’Œæ‹–æ‹½ä¸¤ç§æ–¹å¼
- âœ… çŠ¶æ€å¯è§†åŒ–ï¼Œæ–¹ä¾¿è°ƒè¯•å’Œä¼˜åŒ–
- âœ… ç¬¦åˆç°ä»£ Agent å¹³å°çš„è®¾è®¡ç†å¿µï¼ˆæ‰£å­ã€Difyï¼‰

---

## ğŸ“Š æ ¸å¿ƒåŠŸèƒ½

### 1. è¡¨å•åˆ›å»ºå·¥ä½œæµ

**ç”¨æˆ·æ“ä½œ**ï¼š
1. ç‚¹å‡»"åˆ›å»ºå·¥ä½œæµ"æŒ‰é’®
2. å¼¹å‡ºè¡¨å•ï¼ˆModalï¼‰
3. å¡«å†™è¡¨å•ï¼š
   - **èµ·ç‚¹**ï¼ˆstartï¼‰ï¼š`GitHub Issue åˆ—è¡¨`
   - **ç»ˆç‚¹**ï¼ˆgoalï¼‰ï¼š`å‘é€åˆ°é’‰é’‰ç¾¤`
   - **æè¿°**ï¼ˆdescriptionï¼‰ï¼š`æ¯å¤©å®šæ—¶è·å– GitHub Issue å¹¶å‘é€åˆ°é’‰é’‰ç¾¤`
4. ç‚¹å‡»"æäº¤"

**AI ç”Ÿæˆå·¥ä½œæµ**ï¼š
```
å·¥ä½œæµåç§°ï¼šGitHub Issue é€šçŸ¥
èŠ‚ç‚¹ï¼š
  1. [HTTP] è·å– GitHub Issue
     - URL: https://api.github.com/repos/{owner}/{repo}/issues
     - Method: GET
     - ä½ç½®: (100, 100)

  2. [Transform] æ ¼å¼åŒ–æ¶ˆæ¯
     - è¾“å…¥ï¼šIssue åˆ—è¡¨
     - è¾“å‡ºï¼šé’‰é’‰æ¶ˆæ¯æ ¼å¼
     - ä½ç½®: (100, 250)

  3. [HTTP] å‘é€é’‰é’‰é€šçŸ¥
     - URL: {webhook_url}
     - Method: POST
     - ä½ç½®: (100, 400)

è¾¹ï¼š
  1 â†’ 2 â†’ 3
```

**AI å›å¤æ¶ˆæ¯**ï¼š
```
æˆ‘ä¸ºä½ åˆ›å»ºäº†ä¸€ä¸ªå·¥ä½œæµï¼ŒåŒ…å« 3 ä¸ªæ­¥éª¤ï¼š
1. ä» GitHub è·å– Issue åˆ—è¡¨
2. æ ¼å¼åŒ–ä¸ºé’‰é’‰æ¶ˆæ¯æ ¼å¼
3. å‘é€åˆ°é’‰é’‰ç¾¤

ä½ å¯ä»¥é€šè¿‡å³ä¾§çš„å¯¹è¯æ¡†è°ƒæ•´å·¥ä½œæµï¼Œæˆ–è€…ç›´æ¥æ‹–æ‹½èŠ‚ç‚¹ã€‚
```

---

### 2. å¯¹è¯å¼è°ƒæ•´å·¥ä½œæµ

**ç”¨æˆ·è¾“å…¥**ï¼ˆåœ¨å³ä¾§å¯¹è¯æ¡†ï¼‰ï¼š
```
ç”¨æˆ·: åœ¨å‘é€é’‰é’‰ä¹‹å‰ï¼Œå…ˆä¿å­˜åˆ°æ•°æ®åº“
```

**AI å›å¤**ï¼š
```
AI: å¥½çš„ï¼Œæˆ‘åœ¨æ­¥éª¤ 2 å’Œ 3 ä¹‹é—´æ·»åŠ äº†"ä¿å­˜åˆ°æ•°æ®åº“"èŠ‚ç‚¹ï¼š

å·¥ä½œæµæ›´æ–°ï¼š
  1. [HTTP] è·å– GitHub Issue
  2. [Transform] æ ¼å¼åŒ–æ¶ˆæ¯
  3. [SQL] ä¿å­˜ Issue è®°å½•  â† æ–°å¢
     - SQL: INSERT INTO issues (title, body) VALUES (?, ?)
     - ä½ç½®: (100, 325)
  4. [HTTP] å‘é€é’‰é’‰é€šçŸ¥

è¾¹ï¼š
  1 â†’ 2 â†’ 3 â†’ 4

æ˜¯å¦è¿˜éœ€è¦è°ƒæ•´ï¼Ÿ
```

**å·¥ä½œæµå›¾è¡¨è‡ªåŠ¨æ›´æ–°**ï¼š
- æ–°å¢èŠ‚ç‚¹ 3ï¼ˆSQLï¼‰
- è‡ªåŠ¨è°ƒæ•´èŠ‚ç‚¹ä½ç½®
- æ›´æ–°è¿çº¿

---

### 3. å¯è§†åŒ–æ‹–æ‹½è°ƒæ•´

**ç•Œé¢**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å·¥ä½œæµç¼–è¾‘å™¨                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å·¥ä½œæµç”»å¸ƒï¼ˆReact Flowï¼‰         â”‚  å¯¹è¯æ¡†                   â”‚
â”‚                                  â”‚                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚  ç”¨æˆ·: åœ¨å‘é€é’‰é’‰ä¹‹å‰ï¼Œ   â”‚
â”‚   â”‚ GitHub   â”‚  âœ… æˆåŠŸ          â”‚  å…ˆä¿å­˜åˆ°æ•°æ®åº“           â”‚
â”‚   â”‚ API      â”‚                   â”‚                          â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                   â”‚  AI: å¥½çš„ï¼Œæˆ‘åœ¨æ­¥éª¤ 2    â”‚
â”‚        â”‚                         â”‚  å’Œ 3 ä¹‹é—´æ·»åŠ äº†...       â”‚
â”‚        â–¼                         â”‚                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚  [è¾“å…¥æ¡†]                â”‚
â”‚   â”‚ æ•°æ®è½¬æ¢  â”‚  â³ è¿è¡Œä¸­        â”‚  [å‘é€]                  â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                   â”‚                          â”‚
â”‚        â”‚                         â”‚                          â”‚
â”‚        â–¼                         â”‚                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚                          â”‚
â”‚   â”‚ ä¿å­˜æ•°æ®åº“â”‚  â¸ï¸ æœªæ‰§è¡Œ        â”‚                          â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                   â”‚                          â”‚
â”‚        â”‚                         â”‚                          â”‚
â”‚        â–¼                         â”‚                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚                          â”‚
â”‚   â”‚ é’‰é’‰é€šçŸ¥  â”‚  âŒ å¤±è´¥          â”‚                          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚                          â”‚
â”‚                                  â”‚                          â”‚
â”‚  [æ‰§è¡Œå·¥ä½œæµ] [ä¿å­˜]              â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠŸèƒ½**ï¼š
- âœ… æ‹–æ‹½èŠ‚ç‚¹ä½ç½®
- âœ… è¿æ¥èŠ‚ç‚¹ï¼ˆåˆ›å»ºè¾¹ï¼‰
- âœ… ç¼–è¾‘èŠ‚ç‚¹å±æ€§ï¼ˆåŒå‡»èŠ‚ç‚¹ï¼‰
- âœ… åˆ é™¤èŠ‚ç‚¹ï¼ˆé€‰ä¸­åæŒ‰ Deleteï¼‰
- âœ… æ·»åŠ æ–°èŠ‚ç‚¹ï¼ˆä»å·¦ä¾§å·¥å…·æ æ‹–æ‹½ï¼‰
- âœ… å®æ—¶æ˜¾ç¤ºèŠ‚ç‚¹çŠ¶æ€ï¼ˆæˆåŠŸ/å¤±è´¥/è¿è¡Œä¸­/æœªæ‰§è¡Œï¼‰

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### åç«¯æ¶æ„

#### æ ¸å¿ƒå®ä½“

**Workflowï¼ˆå·¥ä½œæµï¼‰**ï¼š
```python
@dataclass
class Workflow:
    id: str
    name: str
    description: str
    nodes: List[Node]  # èŠ‚ç‚¹åˆ—è¡¨
    edges: List[Edge]  # è¾¹åˆ—è¡¨
    created_at: datetime
    updated_at: datetime
```

**Nodeï¼ˆèŠ‚ç‚¹ï¼‰**ï¼š
```python
@dataclass
class Node:
    id: str
    type: NodeType  # HTTP, SQL, Script, Transform, etc.
    name: str
    config: Dict[str, Any]  # èŠ‚ç‚¹é…ç½®
    position: Position  # åœ¨ç”»å¸ƒä¸Šçš„ä½ç½®
```

**Edgeï¼ˆè¾¹ï¼‰**ï¼š
```python
@dataclass
class Edge:
    id: str
    source_node_id: str
    target_node_id: str
    condition: Optional[str]  # æ¡ä»¶è¡¨è¾¾å¼ï¼ˆå¯é€‰ï¼‰
```

---

#### Use Cases

**1. CreateWorkflowByChatUseCase**ï¼š
```python
class CreateWorkflowByChatUseCase:
    """é€šè¿‡å¯¹è¯åˆ›å»ºå·¥ä½œæµ"""

    async def execute(self, user_message: str) -> Workflow:
        # 1. ä½¿ç”¨ LangChain Agent ç†è§£ç”¨æˆ·æ„å›¾
        intent = await self.intent_parser.parse(user_message)

        # 2. ç”Ÿæˆå·¥ä½œæµç»“æ„
        workflow = await self.workflow_generator.generate(intent)

        # 3. ä¿å­˜å·¥ä½œæµ
        await self.workflow_repo.save(workflow)

        return workflow
```

**2. UpdateWorkflowByChatUseCase**ï¼š
```python
class UpdateWorkflowByChatUseCase:
    """é€šè¿‡å¯¹è¯è°ƒæ•´å·¥ä½œæµ"""

    async def execute(
        self,
        workflow_id: str,
        user_message: str
    ) -> Workflow:
        # 1. è·å–ç°æœ‰å·¥ä½œæµ
        workflow = await self.workflow_repo.get(workflow_id)

        # 2. ä½¿ç”¨ LangChain Agent ç†è§£è°ƒæ•´æ„å›¾
        modification = await self.modification_parser.parse(
            user_message,
            workflow
        )

        # 3. åº”ç”¨ä¿®æ”¹
        updated_workflow = await self.workflow_modifier.apply(
            workflow,
            modification
        )

        # 4. ä¿å­˜æ›´æ–°
        await self.workflow_repo.update(updated_workflow)

        return updated_workflow
```

**3. UpdateWorkflowByDragUseCase**ï¼š
```python
class UpdateWorkflowByDragUseCase:
    """é€šè¿‡æ‹–æ‹½è°ƒæ•´å·¥ä½œæµ"""

    async def execute(
        self,
        workflow_id: str,
        changes: WorkflowChanges
    ) -> Workflow:
        # 1. è·å–ç°æœ‰å·¥ä½œæµ
        workflow = await self.workflow_repo.get(workflow_id)

        # 2. åº”ç”¨æ‹–æ‹½ä¿®æ”¹
        workflow.apply_changes(changes)

        # 3. éªŒè¯å·¥ä½œæµæœ‰æ•ˆæ€§
        self.workflow_validator.validate(workflow)

        # 4. ä¿å­˜æ›´æ–°
        await self.workflow_repo.update(workflow)

        return workflow
```

**4. ExecuteWorkflowUseCase**ï¼š
```python
class ExecuteWorkflowUseCase:
    """æ‰§è¡Œå·¥ä½œæµ"""

    async def execute(
        self,
        workflow_id: str,
        input_data: Dict[str, Any]
    ) -> Run:
        # 1. è·å–å·¥ä½œæµ
        workflow = await self.workflow_repo.get(workflow_id)

        # 2. åˆ›å»º Run
        run = Run.create(workflow_id=workflow_id, input_data=input_data)

        # 3. æ‰§è¡Œå·¥ä½œæµï¼ˆæŒ‰æ‹“æ‰‘æ’åºæ‰§è¡ŒèŠ‚ç‚¹ï¼‰
        await self.workflow_executor.execute(workflow, run)

        return run
```

---

### å‰ç«¯æ¶æ„

#### æ ¸å¿ƒç»„ä»¶

**1. WorkflowChatï¼ˆå¯¹è¯ç•Œé¢ï¼‰**ï¼š
```typescript
// å¯¹è¯å¼åˆ›å»ºå’Œè°ƒæ•´å·¥ä½œæµ
<WorkflowChat
  workflowId={workflowId}
  onWorkflowCreated={(workflow) => {
    // è·³è½¬åˆ°å·¥ä½œæµç¼–è¾‘å™¨
    navigate(`/workflows/${workflow.id}/edit`);
  }}
  onWorkflowUpdated={(workflow) => {
    // åˆ·æ–°å·¥ä½œæµæ˜¾ç¤º
    refetch();
  }}
/>
```

**2. WorkflowEditorï¼ˆæ‹–æ‹½ç¼–è¾‘å™¨ï¼‰**ï¼š
```typescript
// ä½¿ç”¨ React Flow å®ç°
import ReactFlow from 'reactflow';

<WorkflowEditor
  workflow={workflow}
  onSave={(updatedWorkflow) => {
    updateWorkflow.mutate(updatedWorkflow);
  }}
/>
```

**3. WorkflowViewerï¼ˆåªè¯»æŸ¥çœ‹å™¨ï¼‰**ï¼š
```typescript
// åªè¯»çš„å·¥ä½œæµå¯è§†åŒ–
<WorkflowViewer
  workflow={workflow}
  readOnly={true}
/>
```

---

## ğŸš€ å¼€å‘ä¼˜å…ˆçº§

### ç¬¬ä¸€é˜¶æ®µï¼šå¯¹è¯å¼åˆ›å»ºå’Œè°ƒæ•´ï¼ˆP0ï¼‰

**ç›®æ ‡**ï¼šå®ç°æ ¸å¿ƒçš„å¯¹è¯å¼äº¤äº’

**åç«¯**ï¼š
- âœ… Workflowã€Nodeã€Edge å®ä½“
- âœ… CreateWorkflowByChatUseCase
- âœ… UpdateWorkflowByChatUseCase
- âœ… ExecuteWorkflowUseCase
- âœ… LangChain Agentï¼ˆç†è§£ç”¨æˆ·æ„å›¾ï¼‰
- âœ… API æ¥å£

**å‰ç«¯**ï¼š
- âœ… TypeScript ç±»å‹å®šä¹‰
- âœ… API å®¢æˆ·ç«¯
- âœ… TanStack Query Hooks
- âœ… WorkflowChat ç»„ä»¶ï¼ˆä½¿ç”¨ V0 æ¨¡æ¿ï¼‰
- âœ… WorkflowViewer ç»„ä»¶ï¼ˆåªè¯»ï¼Œä½¿ç”¨ React Flowï¼‰

**æ—¶é—´**ï¼š1-2 å‘¨

---

### ç¬¬äºŒé˜¶æ®µï¼šå¯è§†åŒ–æ‹–æ‹½è°ƒæ•´ï¼ˆP1ï¼‰

**ç›®æ ‡**ï¼šå®ç°æ‹–æ‹½ç¼–è¾‘åŠŸèƒ½

**åç«¯**ï¼š
- âœ… UpdateWorkflowByDragUseCase
- âœ… å·¥ä½œæµéªŒè¯é€»è¾‘

**å‰ç«¯**ï¼š
- âœ… WorkflowEditor ç»„ä»¶ï¼ˆä½¿ç”¨ React Flow + V0 æ¨¡æ¿ï¼‰
- âœ… èŠ‚ç‚¹æ‹–æ‹½
- âœ… è¿çº¿
- âœ… èŠ‚ç‚¹å±æ€§ç¼–è¾‘

**æ—¶é—´**ï¼š1 å‘¨

---

### ç¬¬ä¸‰é˜¶æ®µï¼šä¼˜åŒ–å’Œå¢å¼ºï¼ˆP2ï¼‰

**ç›®æ ‡**ï¼šæå‡ç”¨æˆ·ä½“éªŒ

**åŠŸèƒ½**ï¼š
- âœ… å·¥ä½œæµæ¨¡æ¿åº“
- âœ… å·¥ä½œæµç‰ˆæœ¬ç®¡ç†
- âœ… å·¥ä½œæµåˆ†äº«
- âœ… å·¥ä½œæµå¸‚åœº

**æ—¶é—´**ï¼š2-3 å‘¨

---

## ğŸ“ API è®¾è®¡

### 1. åˆ›å»ºå·¥ä½œæµï¼ˆè¡¨å•å¼ï¼‰

```http
POST /workflows

Request:
{
  "start": "GitHub Issue åˆ—è¡¨",
  "goal": "å‘é€åˆ°é’‰é’‰ç¾¤",
  "description": "æ¯å¤©å®šæ—¶è·å– GitHub Issue å¹¶å‘é€åˆ°é’‰é’‰ç¾¤"
}

Response:
{
  "workflow": {
    "id": "wf_123",
    "name": "GitHub Issue é€šçŸ¥",
    "description": "æ¯å¤©å®šæ—¶è·å– GitHub Issue å¹¶å‘é€åˆ°é’‰é’‰ç¾¤",
    "nodes": [
      {
        "id": "node_1",
        "type": "http",
        "name": "è·å– GitHub Issue",
        "config": {
          "url": "https://api.github.com/repos/{owner}/{repo}/issues",
          "method": "GET"
        },
        "position": { "x": 100, "y": 100 }
      },
      {
        "id": "node_2",
        "type": "transform",
        "name": "æ ¼å¼åŒ–æ¶ˆæ¯",
        "config": {
          "script": "..."
        },
        "position": { "x": 100, "y": 250 }
      },
      {
        "id": "node_3",
        "type": "http",
        "name": "å‘é€é’‰é’‰é€šçŸ¥",
        "config": {
          "url": "{webhook_url}",
          "method": "POST"
        },
        "position": { "x": 100, "y": 400 }
      }
    ],
    "edges": [
      { "id": "edge_1", "source_node_id": "node_1", "target_node_id": "node_2" },
      { "id": "edge_2", "source_node_id": "node_2", "target_node_id": "node_3" }
    ],
    "status": "draft",
    "created_at": "2025-01-15T10:00:00Z",
    "updated_at": "2025-01-15T10:00:00Z"
  },
  "ai_message": "æˆ‘ä¸ºä½ åˆ›å»ºäº†ä¸€ä¸ªå·¥ä½œæµï¼ŒåŒ…å« 3 ä¸ªæ­¥éª¤ï¼š\n1. ä» GitHub è·å– Issue åˆ—è¡¨\n2. æ ¼å¼åŒ–ä¸ºé’‰é’‰æ¶ˆæ¯æ ¼å¼\n3. å‘é€åˆ°é’‰é’‰ç¾¤\n\nä½ å¯ä»¥é€šè¿‡å³ä¾§çš„å¯¹è¯æ¡†è°ƒæ•´å·¥ä½œæµï¼Œæˆ–è€…ç›´æ¥æ‹–æ‹½èŠ‚ç‚¹ã€‚"
}
```

---

### 2. è°ƒæ•´å·¥ä½œæµï¼ˆå¯¹è¯å¼ï¼‰

```http
POST /workflows/{workflow_id}/chat

Request:
{
  "message": "åœ¨å‘é€é’‰é’‰ä¹‹å‰ï¼Œå…ˆä¿å­˜åˆ°æ•°æ®åº“"
}

Response:
{
  "workflow": {
    "id": "wf_123",
    "nodes": [...],  // æ›´æ–°åçš„èŠ‚ç‚¹
    "edges": [...]   // æ›´æ–°åçš„è¾¹
  },
  "ai_response": "å¥½çš„ï¼Œæˆ‘åœ¨æ­¥éª¤ 2 å’Œ 3 ä¹‹é—´æ·»åŠ äº†..."
}
```

---

### 3. è°ƒæ•´å·¥ä½œæµï¼ˆæ‹–æ‹½å¼ï¼‰

```http
PATCH /workflows/{workflow_id}

Request:
{
  "nodes": [...],  // æ›´æ–°åçš„èŠ‚ç‚¹
  "edges": [...]   // æ›´æ–°åçš„è¾¹
}

Response:
{
  "workflow": {
    "id": "wf_123",
    "nodes": [...],
    "edges": [...]
  }
}
```

---

### 4. æ‰§è¡Œå·¥ä½œæµ

```http
POST /workflows/{workflow_id}/runs

Request:
{
  "input_data": {
    "repo_owner": "facebook",
    "repo_name": "react",
    "webhook_url": "https://oapi.dingtalk.com/robot/send?access_token=xxx"
  }
}

Response:
{
  "run": {
    "id": "run_456",
    "workflow_id": "wf_123",
    "status": "running",
    "node_executions": [
      {
        "id": "ne_1",
        "node_id": "node_1",
        "status": "pending",
        "input_data": {},
        "output_data": null
      },
      {
        "id": "ne_2",
        "node_id": "node_2",
        "status": "pending",
        "input_data": {},
        "output_data": null
      },
      {
        "id": "ne_3",
        "node_id": "node_3",
        "status": "pending",
        "input_data": {},
        "output_data": null
      }
    ],
    "started_at": "2025-01-15T10:05:00Z",
    "finished_at": null
  }
}
```

### 5. è·å–æ‰§è¡ŒçŠ¶æ€ï¼ˆSSEï¼‰

```http
GET /workflows/{workflow_id}/runs/{run_id}/events

Response (Server-Sent Events):
event: node_execution_started
data: {"node_id": "node_1", "status": "running"}

event: node_execution_completed
data: {"node_id": "node_1", "status": "succeeded", "output_data": {...}}

event: node_execution_started
data: {"node_id": "node_2", "status": "running"}

event: node_execution_completed
data: {"node_id": "node_2", "status": "succeeded", "output_data": {...}}

event: node_execution_started
data: {"node_id": "node_3", "status": "running"}

event: node_execution_failed
data: {"node_id": "node_3", "status": "failed", "error_message": "Webhook URL is invalid"}

event: run_completed
data: {"run_id": "run_456", "status": "failed"}
```

---

## ğŸ”§ æŠ€æœ¯é€‰å‹

### åç«¯

- **LangChain Agent**ï¼šç†è§£ç”¨æˆ·æ„å›¾ï¼Œç”Ÿæˆå·¥ä½œæµ
- **å·¥ä½œæµå¼•æ“**ï¼šæ‰§è¡Œå·¥ä½œæµï¼ˆæ‹“æ‰‘æ’åº + èŠ‚ç‚¹æ‰§è¡Œï¼‰
- **æ•°æ®ç»“æ„**ï¼šWorkflowã€Nodeã€Edge

### å‰ç«¯

- **React Flow**ï¼šå·¥ä½œæµå¯è§†åŒ–å’Œæ‹–æ‹½ç¼–è¾‘
  - å®˜ç½‘ï¼šhttps://reactflow.dev/
  - ç‰¹ç‚¹ï¼šæœ€æµè¡Œçš„ React å·¥ä½œæµåº“
  - ä½¿ç”¨åœºæ™¯ï¼šæ‰£å­ã€Dify ç­‰éƒ½åŸºäºç±»ä¼¼çš„åº“

- **V0 æ¨¡æ¿**ï¼š
  - èŠå¤©ç•Œé¢æ¨¡æ¿
  - å·¥ä½œæµç¼–è¾‘å™¨æ¨¡æ¿

---

## âœ… æ€»ç»“

### æ ¸å¿ƒå˜æ›´

1. **ä»è¡¨å•åˆ›å»º â†’ å¯¹è¯åˆ›å»º**
2. **ä» Agent â†’ Workflow**
3. **æ–°å¢å¯è§†åŒ–ç¼–è¾‘å™¨**

### å¼€å‘ç­–ç•¥

1. **å…ˆå¯¹è¯ï¼Œåæ‹–æ‹½**ï¼ˆéªŒè¯æ ¸å¿ƒä»·å€¼ï¼‰
2. **ä½¿ç”¨ V0 æ¨¡æ¿**ï¼ˆå¿«é€Ÿå®ç° UIï¼‰
3. **ä½¿ç”¨ React Flow**ï¼ˆä¸“ä¸šçš„å·¥ä½œæµåº“ï¼‰

### é¢„æœŸæ•ˆæœ

- âœ… é™ä½ä½¿ç”¨é—¨æ§›ï¼ˆè‡ªç„¶è¯­è¨€äº¤äº’ï¼‰
- âœ… æå‡ç”¨æˆ·ä½“éªŒï¼ˆå¯è§†åŒ–åé¦ˆï¼‰
- âœ… å¢å¼ºçµæ´»æ€§ï¼ˆå¯¹è¯ + æ‹–æ‹½ä¸¤ç§è°ƒæ•´æ–¹å¼ï¼‰
- âœ… ç¬¦åˆè¡Œä¸šæ ‡å‡†ï¼ˆç±»ä¼¼æ‰£å­ã€Difyï¼‰
